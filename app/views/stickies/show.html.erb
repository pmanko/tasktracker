<% @title = "Task #{@sticky.name}" %>
<div class="page-header">
  <h1>
    <%= link_to @sticky.project.name, @sticky.project %> &middot;
    <span style="<%= 'text-decoration:line-through' if @sticky.completed? %>"><%= @title %></span>
  </h1>
  <% if @sticky.modifiable_by?(current_user) %>
    <%= link_to 'Edit Task', edit_sticky_path(@sticky), class: 'btn btn-xs btn-default' %>
    <% if @sticky.group %>
      <%= link_to 'Delete Task', '#', class: 'btn btn-xs btn-danger-inverse', data: { object: 'modal-show', target: "#delete-sticky-dialog_#{@sticky.id}" } %>
    <% else %>
      <%= link_to 'Delete Task', @sticky, method: :delete, class: 'btn btn-xs btn-danger-inverse', data: { confirm: "Are you sure you want to delete Task #{@sticky.name}?" } %>
    <% end %>
  <% end %>
</div>
<%= render partial: 'delete_sticky_dialog', locals: { sticky: @sticky } %>

<dl class="dl-horizontal">
  <dt>Description</dt>
  <dd class="long-description"><%= simple_markdown @sticky.full_description %></dd>

  <dt>Creator</dt>
  <dd><%= link_to @sticky.user.name, @sticky.user %></dd>

  <dt>Board</dt>
  <dd><%= link_to @sticky.board ? @sticky.board.name : 'Holding Pen', project_path(@sticky.project, board: @sticky.board ? @sticky.board.name : nil) %></dd>

  <% if @sticky.owner %>
    <dt>Assigned To</dt>
    <dd><%= link_to @sticky.owner.name if @sticky.owner %></dd>
  <% end %>

  <% unless @sticky.due_date.blank? %>
    <dt>Due Date</dt>
    <dd><%= simple_date_and_weekday @sticky.due_date %></dd>
  <% end %>

  <% unless @sticky.all_day? %>
    <dt>Due At</dt>
    <dd><%= @sticky.due_time %></dd>

    <% if @sticky.duration > 0 %>
      <dt>Duration</dt>
      <dd><%= @sticky.duration %> <%= @sticky.duration_units %></dd>
    <% end %>
  <% end %>

  <% if @sticky.tags.size > 0 %>
    <dt>Tags</dt>
    <dd>
      <% @sticky.tags.in_groups_of(4).each do |row_tags| %>
        <div class="row" style="margin-left:0px;line-height:20px">
          <% row_tags.each_with_index do |tag, index| %>
            <div class="col-md-2" style="<%= 'margin-left:0px' if index == 0 %>"><% if tag %><%= @tag = tag; render partial: 'tags/show' %><% end %></div>
          <% end %>
        </div>
      <% end %>
    </dd>
  <% end %>
</dl>


<% if @sticky.group %>
  <h3>Group <%= link_to @sticky.group.name, @sticky.group if @sticky.group %></h3>
  <% if true %>
    <div class="clearfix">&nbsp;</div>
    <%= render partial: 'stickies/list', locals: { stickies: @sticky.group.stickies } %>
    <%= render partial: 'stickies/modal' %>
  <% else %>
    <%= @stickies = @sticky.group.stickies; render partial: 'stickies/simple_stickies' %>
  <% end %>
<% end %>

<div id="sticky_<%= @sticky.id %>_comments">
  <%= @comments = @sticky.comments.page(0).per(0); render partial: 'comments/index' %>
</div>
